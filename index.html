<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kassensystem Veranstaltung</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      background: #f7f7f7;
      min-height: 100vh;
    }
    .container {
      display: flex;
      flex-direction: row;
      padding: 1rem;
      gap: 2rem;
      flex-wrap: wrap;
      max-width: 1100px;
      margin: 0 auto;
    }
    @media (max-width: 900px) {
      .container {
        flex-direction: column;
        gap: 1rem;
      }
    }
    .products, .cart {
      flex: 1;
      background: white;
      padding: 1rem;
      border-radius: 10px;
      min-width: 320px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.07);
    }
    .products h2,
    .cart h2 {
      text-align: left;
      margin-top: 0;
      margin-bottom: 1rem;
      letter-spacing: 1px;
      font-size: 1.3rem;
      color: #444;
    }
    .product {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
      padding: 0.8rem 0;
      border-bottom: 1px solid #eee;
    }
    .product .info {
      flex-grow: 1;
      text-align: center;
      font-size: 1.07rem;
    }
    .product .product-description {
      font-size: 0.92rem;
      color: #666;
      margin-top: 0.3rem;
    }
    .product button {
      padding: 1rem 1.5rem;
      font-size: 2.2rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      width: 60px; height: 60px;
      display: flex; justify-content: center; align-items: center;
      user-select: none;
      transition: transform 0.08s;
      outline: none;
    }
    .product button:active {
      transform: scale(0.94);
      background: #bdd9ce;
      color: black;
    }
    .product button.minus {
      background: #dc3545;
      color: white;
      order: 0;
      margin-right: 1rem;
    }
    .product button.plus {
      background: #28a745;
      color: white;
      order: 2;
      margin-left: 1rem;
    }
    .product .counter {
      width: 40px;
      text-align: center;
      font-size: 1.37rem;
      padding: 0 5px;
      font-variant-numeric: tabular-nums;
    }
    .cart ul {
      list-style: none;
      padding: 0;
      margin-top: 0;
    }
    .cart li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.57rem 0;
      border-bottom: 1px solid #f1f1f1;
      font-size: 1.12rem;
    }
    .total {
      font-weight: bold;
      font-size: 1.55rem;
      margin-top: 1rem;
      text-align: right;
    }
    .payment {
      margin-top: 1.1rem;
    }
    .cash-display {
      font-size: 2.1rem;
      background: #eee;
      text-align: right;
      padding: 1.1rem;
      margin-bottom: 1rem;
      border-radius: 6px;
      letter-spacing: 1px;
      min-width: 130px;
    }
    .numpad {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 11px;
      margin-bottom: 10px;
    }
    .numpad button {
      padding: 1.5rem;
      font-size: 2rem;
      border-radius: 8px;
      border: none;
      background: #ddd;
      cursor: pointer;
      user-select: none;
      transition: transform 0.08s;
    }
    .numpad button:active {
      background: #bcd4ec;
      transform: scale(0.96);
    }
    .pay-button, .change-display {
      margin-top: 0.6rem;
      width: 100%;
      padding: 1.4rem;
      font-size: 1.25rem;
      border-radius: 8px;
      text-align: center;
      display: block;
      box-sizing: border-box;
    }
    .pay-button {
      background: #007bff;
      color: white;
      border: none;
      font-weight: bold;
      letter-spacing: 1px;
    }
    .pay-button:active { background: #005fb5; }
    .clear {
      background: #dc3545;
      margin-top: 0.6rem;
    }
    .clear:active { background: #b21c35; }
    .change-display {
      background: #28a745;
      color: white;
      font-weight: bold;
      margin-bottom: 0.6rem;
      box-shadow: 0 0 6px #b9dcb8;
      outline: 0.5px solid #81bf87;
      letter-spacing: 1px;
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="products">
      <h2>Produkte</h2>
      <div class="product">
        <button class="minus" onclick="removeFromCart('Cocktails')">−</button>
        <div class="info">
          <span><strong>Cocktails</strong> <br>
          <span style="color:#292;"><b>6,00</b> €</span>
          <!-- Pfand 1,00 € -->
          </span>
        </div>
        <span class="counter" id="counter-Cocktails">0</span>
        <button class="plus" onclick="addToCart('Cocktails', 6, 1)">+</button>
      </div>
      <div class="product">
        <button class="minus" onclick="removeFromCart('Sekt')">−</button>
        <div class="info">
          <span><strong>Sekt</strong> <br>
          <span style="color:#292;"><b>4,00</b> €</span>
          <!-- Pfand 1,00 € -->
          </span>
        </div>
        <span class="counter" id="counter-Sekt">0</span>
        <button class="plus" onclick="addToCart('Sekt', 4, 1)">+</button>
      </div>
      <div class="product">
        <button class="minus" onclick="removeFromCart('Shots')">−</button>
        <div class="info">
          <span><strong>Shots</strong> <br>
          <span style="color:#292;"><b>2,00</b> €</span></span>
          <div class="product-description">3 Shots für <b>5,00 €</b> <span style="color:#3a7339;">(Rabatt!)</span> – kein Pfand</div>
        </div>
        <span class="counter" id="counter-Shots">0</span>
        <button class="plus" onclick="addToCart('Shots', 2, 0)">+</button>
      </div>

      <div class="product">
        <button class="minus" onclick="removeFromCart('Softdrinks')">−</button>
        <div class="info">
          <span><strong>Softdrinks</strong> <br>
          <span style="color:#292;"><b>3,00</b> €</span>
          <!-- Pfand 1,00 € -->
          </span>
        </div>
        <span class="counter" id="counter-Softdrinks">0</span>
        <button class="plus" onclick="addToCart('Softdrinks', 3, 1)">+</button>
      </div>

      <div class="product">
        <button class="minus" onclick="removeFromCart('Wasser')">−</button>
        <div class="info">
          <span><strong>Wasser</strong> <br>
          <span style="color:#292;"><b>2,00</b> €</span>
          <!-- Pfand 1,00 € -->
          </span>
        </div>
        <span class="counter" id="counter-Wasser">0</span>
        <button class="plus" onclick="addToCart('Wasser', 2, 1)">+</button>
      </div>

      <div class="product">
        <button class="minus" onclick="removeFromCart('PfandRückgabe')">−</button>
        <div class="info">
          <span><strong>Pfand-Rückgabe</strong> <br>
          <span style="color:#cf2a2a;"><b>–1,00</b> €</span></span>
          <div class="product-description">Rückgabe von Pfand (Cocktails, Sekt, Softdrinks, Wasser)</div>
        </div>
        <span class="counter" id="counter-PfandRückgabe">0</span>
        <button class="plus" onclick="addToCart('PfandRückgabe', -1, 0)">+</button>
      </div>
    </div>
    <div class="cart">
      <h2>Warenkorb</h2>
      <ul id="cartList"></ul>
      <div class="total">
        Gesamt: <span id="total">0.00</span> €
      </div>
      <div class="payment">
        <div class="cash-display" id="cashDisplay">0.00 €</div>
        <div class="numpad">
          <button onclick="appendCash('1')">1</button>
          <button onclick="appendCash('2')">2</button>
          <button onclick="appendCash('3')">3</button>
          <button onclick="appendCash('4')">4</button>
          <button onclick="appendCash('5')">5</button>
          <button onclick="appendCash('6')">6</button>
          <button onclick="appendCash('7')">7</button>
          <button onclick="appendCash('8')">8</button>
          <button onclick="appendCash('9')">9</button>
          <button onclick="appendCash('.')">.</button>
          <button onclick="appendCash('0')">0</button>
          <button onclick="clearLastCash()">←</button>
        </div>
        <div class="change-display" id="changeDisplay"></div>
        <button class="pay-button clear" onclick="clearCart()">Warenkorb leeren</button>
      </div>
    </div>
  </div>

<script>
  const products = {
    Cocktails: { price: 6, pfand: 1 },
    Sekt: { price: 4, pfand: 1 },
    Shots: { price: 2, pfand: 0 },
    Softdrinks: { price: 3, pfand: 1 },
    Wasser: { price: 2, pfand: 1 },
    PfandRückgabe: { price: -1, pfand: 0 },
  };

  const cartCounts = {
    Cocktails: 0,
    Sekt: 0,
    Shots: 0,
    Softdrinks: 0,
    Wasser: 0,
    PfandRückgabe: 0,
  };

  let cashInput = "";

  function updateProductCounters() {
    for (const name in cartCounts) {
      const el = document.getElementById(`counter-${name}`);
      if (el) el.textContent = cartCounts[name] || "0";
    }
  }

  function addToCart(name, price, pfand) {
    cartCounts[name]++;
    renderCart();
    updateProductCounters();
  }

  function removeFromCart(name) {
    if (cartCounts[name] > 0) {
      cartCounts[name]--;
      renderCart();
      updateProductCounters();
    }
  }

  function renderCart() {
    const cartList = document.getElementById("cartList");
    cartList.innerHTML = "";
    let total = 0;

    let pfandCount = 0;
    let pfandTotal = 0;

    for (const [name, count] of Object.entries(cartCounts)) {
      if (count === 0) continue;

      if (name === "Cocktails" || name === "Sekt" || name === "Softdrinks" || name === "Wasser") {
        const productPrice = products[name].price;
        const itemTotal = count * productPrice;
        const li = document.createElement("li");
        li.innerHTML = `${name} × ${count} = ${itemTotal.toFixed(2)} €`;
        cartList.appendChild(li);
        total += itemTotal;

        pfandCount += count;
        pfandTotal += count * products[name].pfand;

      } else if (name === "Shots") {
        const sets = Math.floor(count / 3);
        const remainder = count % 3;
        const itemTotal = sets * 5 + remainder * products.Shots.price;
        let display = "";
        if (sets > 0) display += `${sets}x 3 Shots (5,00 €) `;
        if (remainder > 0) display += (display ? "+ " : "") + `${remainder}x Shots (${products.Shots.price.toFixed(2)} €) `;
        display += `= ${itemTotal.toFixed(2)} €`;
        const li = document.createElement("li");
        li.innerHTML = display;
        cartList.appendChild(li);
        total += itemTotal;

      } else if (name === "PfandRückgabe") {
        const itemTotal = count * products.PfandRückgabe.price;
        const li = document.createElement("li");
        li.innerHTML = `Pfand-Rückgabe × ${count} = <span style="color:#cf2a2a;">${itemTotal.toFixed(2)} €</span>`;
        cartList.appendChild(li);
        total += itemTotal;
        pfandTotal += itemTotal;  // Pfand Rückgabe reduziert Pfand
      }
    }

    if (pfandCount > 0) {
      const liPfand = document.createElement("li");
      liPfand.innerHTML = `Pfand × ${pfandCount} = <span style="color:#947b2f;">${pfandTotal.toFixed(2)} €</span>`;
      cartList.appendChild(liPfand);
      total += pfandTotal;
    }

    document.getElementById("total").textContent = total.toFixed(2);
    updateChange();
  }

  function appendCash(char) {
    if ((char === "." || char === ",") && (cashInput.includes('.') || cashInput.includes(','))) return;
    if (char === ",") char = ".";
    if (cashInput.includes('.')) {
      if (cashInput.split('.')[1].length >= 2) return;
    }
    if (char === "0" && cashInput === "0") return;
    if (cashInput === "" && char === ".") cashInput = "0";
    cashInput += char;
    updateCashDisplay();
    updateChange();
  }

  function clearLastCash() {
    cashInput = cashInput.slice(0, -1);
    updateCashDisplay();
    updateChange();
  }

  function updateCashDisplay() {
    document.getElementById("cashDisplay").textContent = cashInput 
      ? Number(cashInput).toLocaleString("de-DE", {minimumFractionDigits: 2, maximumFractionDigits: 2}) + " €"
      : "0.00 €";
  }

  function updateChange() {
    const total = parseFloat(document.getElementById("total").textContent.replace(",", "."));
    const cash = parseFloat(cashInput.replace(",", "."));
    const changeDisplay = document.getElementById("changeDisplay");

    if (!isNaN(cash) && cash >= total && total > 0) {
      const change = (cash - total).toFixed(2);
      changeDisplay.style.display = "block";
      changeDisplay.innerHTML = `Rückgeld: <b>${parseFloat(change).toLocaleString("de-DE", {minimumFractionDigits: 2})} €</b>`;
    } else {
      changeDisplay.style.display = "none";
    }
  }

  function clearCart() {
    for (const key in cartCounts) {
      cartCounts[key] = 0;
    }
    renderCart();
    updateProductCounters();
    document.getElementById("changeDisplay").style.display = "none";
    clearCash(false);
  }

  function clearCash(clearChange = true) {
    cashInput = "";
    updateCashDisplay();
    if (clearChange) document.getElementById("changeDisplay").style.display = "none";
  }

  document.addEventListener("keydown", e => {
    // Enter-Taste für Bezahlen entfällt, da automatisches Rückgeld
  });

  renderCart();
  updateCashDisplay();
  updateProductCounters();

  // Für Tablets: Doppeltippen deaktivieren
  document.addEventListener('dblclick', e => e.preventDefault());
</script>
</body>
</html>
